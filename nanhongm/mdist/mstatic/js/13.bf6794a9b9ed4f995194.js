webpackJsonp([13],{NGuO:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("U+Ox"),i=e("7QTg"),a={name:"commoditydetails",data:function(){return{styleindex:0,color:[],type:0,detevas:!1,detevanum:0,shopshowinfo:[],evainfo:{},goodsinfo:[],eva:[],filter:[],class_id:"",fids:[]}},updated:function(){for(var s=document.getElementById("infos-cont").getElementsByTagName("img"),t=0;t<s.length;t++)s[t].style.width="100%",s[t].style.height="100%"},created:function(){document.body.scrollTop=document.documentElement.scrollTop=0,this.class_id=this.$route.query.class_id,this.requst(this.class_id)},methods:{requst:function(s){var t=this;this.$axios.post("/index/shop/getGoodsInfo",{gid:s}).then(function(s){console.log(s),t.goodsinfo=s.data.data,t.shopshowinfo=t.goodsinfo.goods_images[0].image_url,t.eva=t.goodsinfo.goods_commtent;for(var e=0,o=t.goodsinfo.goods_format.length;e<o;e++)t.fids.push([t.goodsinfo.goods_format[e].format_children[0].format_name]),t.color.push([])})},tocar:function(){var s=this;if(console.log(this.fids),0==this.fids.length)this.$toast.fail("您未选择商品属性！");else{var t=JSON.parse(sessionStorage.getItem("vuex")).userid,e=this.goodsinfo.goods_info.goods_id,o=this.fids.join(",");this.$axios.post("/index/shop/addShoppingCart",{userId:t,gid:e,num:1,fids:o}).then(function(t){200==t.data.code?(s.$toast.success("加入购物车成功"),setTimeout(function(){s.$router.push({path:"/shoppingcar"})},500)):s.$toast.fail("添加失败")})}},isstyle:function(s){this.styleindex=s},swiper:function(s,t){this.shopshowinfo=t},toprev:function(){},tonext:function(){},curtype:function(s){this.type=s},curcolor:function(s,t,e){var o=e.format_name;this.fids[s]=o,this.color[s]=t,console.log(this.fids),this.$forceUpdate()},deteva:function(s){this.detevas=!this.detevas,this.detevanum=s,console.log(s)},change:function(s){var t=this.eva.filter(function(t){return t.code==s});this.filter=t},pic:function(){var s=this.eva.filter(function(s){return s.imgs});this.filter=s}},components:{swiper:i.swiper,swiperSlide:i.swiperSlide,evaluate:o.a}},n={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"commoditydetails"},[e("div",{staticClass:"goodsshow"},[e("div",{staticClass:"swiperbox"},[e("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3,"indicator-color":"#2482C8"}},s._l(s.goodsinfo.goods_images,function(t,o){return e("van-swipe-item",{key:o},[e("div",{staticClass:"mainpic",style:{backgroundImage:"url("+s.httpUrl+t.image_url+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}})])}),1)],1),s._v(" "),e("div",{staticClass:"gs-right"},[e("p",{staticClass:"name"},[s._v(s._s(s.goodsinfo.goods_info.goods_name))]),s._v(" "),e("div",{staticClass:"typebox select"},s._l(s.goodsinfo.goods_format,function(t,o){return e("div",{key:o,staticClass:"selectbox"},[e("p",{staticClass:"text"},[s._v(s._s(t.format_name))]),s._v(" "),e("div",{staticClass:"selection"},s._l(t.format_children,function(t,i){return e("section",{key:i,staticClass:"section",class:s.color[o]==i?"cur":"",on:{click:function(e){return s.curcolor(o,i,t)}}},[e("span",{staticClass:"span"}),s._v(" "),e("span",{staticClass:"type"},[s._v(s._s(t.format_name))])])}),0)])}),0),s._v(" "),e("p",{staticClass:"price"},[s._v("￥"+s._s(s.goodsinfo.goods_info.goods_price))]),s._v(" "),e("p",{staticClass:"addcar",on:{click:s.tocar}},[s._v("加入购物车")]),s._v(" "),e("p",{staticClass:"info"},[e("span",{staticClass:"sale"},[s._v("销量："+s._s(s.goodsinfo.goods_info.goods_discount))]),s._v(" "),e("span",[s._v("/")]),s._v(" "),e("span",{staticClass:"stock"},[s._v("库存"+s._s(s.goodsinfo.goods_info.goods_number))])])])]),s._v(" "),e("div",{staticClass:"det-eva"},[e("div",{staticClass:"title"},[e("p",{staticClass:"text",class:0==s.detevas?"deteva":"",on:{click:function(t){return s.deteva(0)}}},[s._v("产品详情")]),s._v(" "),e("p",{staticClass:"text",class:1==s.detevas?"deteva":"",on:{click:function(t){return s.deteva(1)}}},[s._v("用户评价")])]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:0==s.detevanum,expression:"detevanum==0"}],staticClass:"det detevabox"},[e("div",{staticClass:"detinfos scorll",attrs:{id:"infos-cont"},domProps:{innerHTML:s._s(s.goodsinfo.goods_info.goods_contents)}})]),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==s.detevanum,expression:"detevanum==1"}],staticClass:"eva detevabox"},[e("div",{staticClass:"evainfos scorll"},[e("ul",{staticClass:"evalist"},s._l(s.eva,function(t,o){return e("li",{key:o,staticClass:"evali"},[e("div",{staticClass:"evali-left"},[t.user.bd_headimg?e("div",{staticClass:"mainpic",style:{backgroundImage:"url("+s.httpUrl+t.user.bd_headimg+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}):e("div",{staticClass:"mainpic",style:{backgroundImage:"url("+s.httpUrl+t.user.user_image+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}})]),s._v(" "),e("div",{staticClass:"evali-right"},[t.user.user_name?e("p",{staticClass:"name"},[s._v(s._s(t.user.user_name))]):e("p",{staticClass:"name"},[s._v(s._s(t.user.user_nickname))]),s._v(" "),e("p",{staticClass:"time"},[s._v(s._s(t.created_time))]),s._v(" "),e("p",{staticClass:"cont",class:s.styleindex==o?"open":"",domProps:{innerHTML:s._s(t.content)},on:{click:function(t){return s.isstyle(o)}}}),s._v(" "),t.image_url?e("div",{staticClass:"pics"},s._l(t.image_url,function(t,o){return e("div",{key:o,staticClass:"slide"},[e("div",{staticClass:"showpic",style:{backgroundImage:"url("+s.httpUrl+t+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}})])}),0):s._e(),s._v(" "),e("p",{staticClass:"ctype"},[e("span",[s._v(s._s(t.spec))])])])])}),0)])])])])},staticRenderFns:[]};var c=e("VU/8")(a,n,!1,function(s){e("fti4")},"data-v-0145f57d",null);t.default=c.exports},"U+Ox":function(s,t,e){"use strict";var o={name:"evaluate",data:function(){return{something:"",evaindex:0,fileList:[],headimg:["",""],radio:3}},props:{goodsinfos:{type:Object},close:{type:String,default:"false"}},created:function(){},methods:{changeevali:function(s,t,e){this.evaindex=s,this.radio=t.num,this.$forceUpdate()},beforedelete:function(s,t){return console.log(t.index),this.headimg[t.index]="",console.log(this.headimg),!0},afterRead:function(s){var t=this;s.status="success",s.message="上传成功";var e=new FormData;e.append("file",s.file),this.$axios.post("/index/api/uploadPet",e).then(function(s){console.log(s),""==t.headimg[0]?t.headimg[0]=s.data:(t.headimg[1]=s.data)&&(t.headimg[1]=s.data),console.log(t.headimg)})},regtext:function(s){var t=s.replace(/<\/?[^>]*>/g,"");this.something=t},send:function(){var s=this;console.log(this.radio),this.$dialog.confirm({title:"提示",message:"是否立即评价"}).then(function(){var t=s.headimg.join(","),e=[];console.log(s.something,t,s.radio);for(var o=0,i=s.goodsinfos.goods.length;o<i;o++)e.push(s.goodsinfos.goods[o].oe_goods_id);e=e.join(","),console.log(e),s.$axios.post("/index/user/commentList",{userId:s.userid,goods_id:s.goodsinfos.oe_goods_id,order_id:s.goodsinfos.oderid,star:s.radio,content:s.something,image:t}).then(function(t){console.log(t),(t.data.code=200)?(s.$toast.success("评价成功!"),setTimeout(function(){s.$emit("close",!1)},500)):(s.$toast.fail("提交失败"),setTimeout(function(){s.$emit("close",!1)},500))})}).catch(function(){s.$toast.fail("取消评价")}),console.log(this.headimg,this.evaindex,this.something)}}},i={render:function(){var s=this,t=s.$createElement,o=s._self._c||t;return s.close?o("div",{staticClass:"evaluate"},[o("div",{staticClass:"evaluatebox clearFix"},[s._m(0),s._v(" "),o("ul",{staticClass:"goodslist"},[o("li",{staticClass:"goodsli"},[o("div",{staticClass:"goodsinfo"},[o("div",{staticClass:"mainpic",style:{backgroundImage:"url("+s.httpUrl+s.goodsinfos.order_img+")",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),s._v(" "),o("div",{staticClass:"infos"},[o("p",{staticClass:"des"},[s._v(s._s(s.goodsinfos.order_name))]),s._v(" "),o("p",{staticClass:"num"},[o("span",[s._v("￥"+s._s(s.goodsinfos.order_price))])]),s._v(" "),o("img",{attrs:{src:e("gTzT"),alt:""}}),s._v(" "),o("p",{staticClass:"color"})])]),s._v(" "),o("ul",{staticClass:"evalist"},s._l(s.goodsinfos.eva,function(t,e){return o("li",{key:e,staticClass:"evali",class:{sel:s.evaindex==e},attrs:{"data-indexs":e},on:{click:function(o){return s.changeevali(e,t,o)}}},[s._v(s._s(t.title))])}),0),s._v(" "),o("div",{staticClass:"ipteva"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:s.something,expression:"something"}],attrs:{placeholder:"亲，写点评价吧，你的评价对其他买家有很大帮助的。"},domProps:{value:s.something},on:{blur:function(t){return s.regtext(s.something)},input:function(t){t.target.composing||(s.something=t.target.value)}}})]),s._v(" "),o("div",{staticClass:"uploadimg"},[o("van-uploader",{attrs:{"before-delete":s.beforedelete,"after-read":s.afterRead,multiple:"","max-count":2},model:{value:s.fileList,callback:function(t){s.fileList=t},expression:"fileList"}})],1)])]),s._v(" "),o("p",{staticClass:"send",on:{click:s.send}},[s._v("发表评价")])])]):s._e()},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("p",{staticClass:"title"},[t("img",{attrs:{src:e("qUNo"),alt:""}}),this._v(" 评价商品\n    ")])}]};var a=e("VU/8")(o,i,!1,function(s){e("i68k")},"data-v-54bc3890",null);t.a=a.exports},fti4:function(s,t){},i68k:function(s,t){}});
//# sourceMappingURL=13.bf6794a9b9ed4f995194.js.map